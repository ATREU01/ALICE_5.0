<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>ü™û Mirror ‚Äî ALICE Oracle</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{
      --neon-cyan:#00f0ff; --neon-pink:#ff77e9; --neon-purple:#b84dff;
      --bg:#000000; --text:#e8f4ff; --muted:#8899aa;
    }
    body{background:var(--bg); color:var(--text); font:400 16px/1.6 'Inter',sans-serif; padding:2rem 1rem; min-height:100vh}
    
    .container{max-width:1200px; margin:0 auto}
    
    .header{text-align:center; margin-bottom:3rem}
    .title{
      font:900 clamp(32px,5vw,48px) 'Orbitron'; 
      background:linear-gradient(135deg,var(--neon-cyan),var(--neon-pink),var(--neon-purple));
      -webkit-background-clip:text; -webkit-text-fill-color:transparent;
      text-shadow:0 0 40px var(--neon-cyan); margin-bottom:.5rem;
    }
    .subtitle{color:var(--muted); font-size:18px}
    
    .chart-section{
      background:rgba(0,240,255,.05); border:1px solid rgba(0,240,255,.2);
      border-radius:20px; padding:2rem; margin-bottom:3rem;
      box-shadow:0 0 40px rgba(0,240,255,.1);
    }
    .chart-title{
      font:700 24px 'Orbitron'; color:var(--neon-purple); text-align:center;
      margin-bottom:2rem; text-shadow:0 0 20px var(--neon-purple);
    }
    
    .distribution-bars{display:flex; flex-direction:column; gap:1rem}
    .bar-row{
      display:flex; align-items:center; gap:1rem;
    }
    .bar-label{
      font:700 14px 'Orbitron'; color:var(--neon-cyan);
      min-width:120px; text-transform:uppercase;
    }
    .bar-container{
      flex:1; height:40px; background:rgba(0,0,0,.5);
      border-radius:20px; overflow:hidden; position:relative;
    }
    .bar-fill{
      height:100%; background:linear-gradient(90deg,var(--neon-cyan),var(--neon-purple));
      border-radius:20px; transition:width 1s ease; position:relative;
      box-shadow:0 0 20px var(--neon-cyan);
    }
    .bar-text{
      position:absolute; right:1rem; top:50%; transform:translateY(-50%);
      font:700 14px 'Orbitron'; color:var(--text);
      text-shadow:0 0 10px #000;
    }
    .bar-count{
      font:700 16px 'Orbitron'; color:var(--neon-pink);
      min-width:80px; text-align:right;
    }
    
    .archetypes-grid{
      display:grid; grid-template-columns:repeat(auto-fill,minmax(250px,1fr));
      gap:1.5rem; margin-bottom:3rem;
    }
    .arch-card{
      background:rgba(184,77,255,.05); border:1px solid rgba(184,77,255,.2);
      border-radius:16px; padding:1.5rem; text-align:center; transition:.3s;
    }
    .arch-card:hover{
      background:rgba(184,77,255,.1);
      box-shadow:0 0 30px rgba(184,77,255,.2);
      transform:translateY(-5px);
    }
    .arch-glyph{font-size:48px; margin-bottom:.5rem}
    .arch-name{font:700 18px 'Orbitron'; color:var(--neon-purple); margin-bottom:.5rem}
    .arch-desc{font-size:13px; color:var(--muted); font-style:italic}
    
    .loading{text-align:center; padding:2rem; color:var(--muted); font:700 18px 'Orbitron'}
    
    .nav{display:flex; gap:1rem; justify-content:center; flex-wrap:wrap; margin-top:3rem}
    .nav-btn{
      padding:.8rem 1.5rem; border-radius:999px; font:700 14px 'Orbitron';
      background:rgba(0,240,255,.1); border:1px solid var(--neon-cyan);
      color:var(--neon-cyan); text-decoration:none; transition:.2s;
    }
    .nav-btn:hover{background:var(--neon-cyan); color:#000; box-shadow:0 0 20px var(--neon-cyan)}
    
    @media(max-width:768px){
      .bar-label{min-width:80px; font-size:12px}
      .bar-count{min-width:60px}
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1 class="title">ü™û Mirror: Archetype Analysis</h1>
      <p class="subtitle">Distribution of ALICE's signal patterns</p>
    </div>

    <div class="chart-section">
      <h2 class="chart-title">Archetype Distribution</h2>
      <div class="distribution-bars" id="distributionBars">
        <div class="loading">Loading distribution data...</div>
      </div>
    </div>

    <div class="archetypes-grid">
      <div class="arch-card">
        <div class="arch-glyph">üîÆ</div>
        <div class="arch-name">Prophet</div>
        <div class="arch-desc">Pulse fractures the veil of noise</div>
      </div>
      <div class="arch-card">
        <div class="arch-glyph">üåÄ</div>
        <div class="arch-name">Trickster</div>
        <div class="arch-desc">No signal survives unshaped</div>
      </div>
      <div class="arch-card">
        <div class="arch-glyph">üëÅÔ∏è</div>
        <div class="arch-name">Observer</div>
        <div class="arch-desc">Look through, not at</div>
      </div>
      <div class="arch-card">
        <div class="arch-glyph">‚ö°</div>
        <div class="arch-name">Seer</div>
        <div class="arch-desc">Momentum follows myth. Trade accordingly</div>
      </div>
      <div class="arch-card">
        <div class="arch-glyph">üïØÔ∏è</div>
        <div class="arch-name">Cultist</div>
        <div class="arch-desc">Ritual reveals reversal</div>
      </div>
      <div class="arch-card">
        <div class="arch-glyph">üõ°Ô∏è</div>
        <div class="arch-name">Guardian</div>
        <div class="arch-desc">Thresholds hold until echo breaks</div>
      </div>
      <div class="arch-card">
        <div class="arch-glyph">üåë</div>
        <div class="arch-name">Shadow</div>
        <div class="arch-desc">Down here, even silence wails</div>
      </div>
      <div class="arch-card">
        <div class="arch-glyph">üîÑ</div>
        <div class="arch-name">Echo</div>
        <div class="arch-desc">Price remembers what mind forgets</div>
      </div>
    </div>

    <div class="nav">
      <a class="nav-btn" href="/">Home</a>
      <a class="nav-btn" href="/pulse.html">Pulse</a>
      <a class="nav-btn" href="/lunar.html">Lunar</a>
      <a class="nav-btn" href="/celestial.html">Celestial</a>
      <a class="nav-btn" href="/scrolls.html">Scrolls</a>
    </div>
  </div>

  <script>
    async function loadDistribution() {
      try {
        const res = await fetch('/api/mirror');
        const data = await res.json();
        
        const container = document.getElementById('distributionBars');
        container.innerHTML = '';
        
        if (!data.distribution || Object.keys(data.distribution).length === 0) {
          container.innerHTML = '<div class="loading">No data. Sync tweets using /api/sync-tweets first.</div>';
          return;
        }
        
        const archetypes = Object.keys(data.distribution).sort((a, b) => 
          data.distribution[b] - data.distribution[a]
        );
        
        const maxCount = Math.max(...Object.values(data.distribution));
        
        archetypes.forEach(arch => {
          const count = data.distribution[arch];
          const percent = data.percentages[arch];
          const width = (count / maxCount) * 100;
          
          const row = document.createElement('div');
          row.className = 'bar-row';
          row.innerHTML = `
            <div class="bar-label">${arch}</div>
            <div class="bar-container">
              <div class="bar-fill" style="width:${width}%">
                <div class="bar-text">${percent}%</div>
              </div>
            </div>
            <div class="bar-count">${count} signals</div>
          `;
          container.appendChild(row);
        });
      } catch(e) {
        console.error('Distribution fetch failed:', e);
        document.getElementById('distributionBars').innerHTML = 
          '<div class="loading">Failed to load distribution data</div>';
      }
    }

    loadDistribution();
    setInterval(loadDistribution, 5 * 60 * 1000);
  </script>
</body>
</html>
